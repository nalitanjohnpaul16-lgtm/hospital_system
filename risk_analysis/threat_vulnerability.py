matrix = [
    {"Threat": "Data Breach", "Vulnerability": "Weak passwords", "Likelihood": "High", "Impact": "Severe", "Countermeasure": "MFA + Hashing"},
    {"Threat": "Ransomware", "Vulnerability": "Outdated OS", "Likelihood": "Medium", "Impact": "Severe", "Countermeasure": "Firewalls, Patching"},
    {"Threat": "Insider Threat", "Vulnerability": "Excessive privileges", "Likelihood": "Medium", "Impact": "High", "Countermeasure": "RBAC, Access Logs"},
    {"Threat": "Phishing", "Vulnerability": "Staff untrained", "Likelihood": "High", "Impact": "High", "Countermeasure": "Security Awareness Training"},
    {"Threat": "System Downtime", "Vulnerability": "Power outage", "Likelihood": "Medium", "Impact": "High", "Countermeasure": "Backup generator + redundancy"},
    {"Threat": "Unauthorized Access", "Vulnerability": "No biometric", "Likelihood": "High", "Impact": "High", "Countermeasure": "Face recognition + fingerprint"},
    {"Threat": "Network Attack", "Vulnerability": "Weak firewall rules", "Likelihood": "Medium", "Impact": "Severe", "Countermeasure": "IDS/IPS monitoring"},
    {"Threat": "Lost Device", "Vulnerability": "No encryption", "Likelihood": "Medium", "Impact": "High", "Countermeasure": "Full-data encryption"},
]

LIKELIHOOD_SCORE = {"Low": 1, "Medium": 2, "High": 3}
IMPACT_SCORE = {"Low": 1, "Moderate": 2, "High": 3, "Severe": 4}


def show_threat_matrix():
    print("\n--- THREAT & VULNERABILITY MATRIX ---")
    for row in matrix:
        print(f"{row['Threat']} | {row['Vulnerability']} | {row['Likelihood']} | {row['Impact']} | {row['Countermeasure']}")


def calculate_risk_scores():
    print("\n--- RISK SCORING (L x I) ---")
    for row in matrix:
        l = LIKELIHOOD_SCORE.get(row.get("Likelihood"), 0)
        # Map any 'Very High' to 'Severe' for consistency
        impact_key = row.get("Impact")
        if impact_key == "Very High":
            impact_key = "Severe"
        i = IMPACT_SCORE.get(impact_key, 0)
        score = l * i
        level = (
            "Low" if score <= 2 else
            "Moderate" if score <= 4 else
            "High" if score <= 6 else
            "Critical"
        )
        print(f"{row['Threat']} -> Likelihood:{row['Likelihood']} Impact:{row['Impact']} | Score:{score} ({level})")
